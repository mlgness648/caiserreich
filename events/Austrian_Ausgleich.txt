###########################
# Ausgleich Events 3.0
###########################
# By ~mw~
###########################

add_namespace = ausgleich.new

### Ausgleich Preparations
country_event = {
	id = ausgleich.new.100
	immediate = { log = "[GetDateText]: [Root.GetName]: event ausgleich.new.100" }
	title = ausgleich.new.100.t
	desc = ausgleich.new.100.d

	trigger = {
		tag = AUS
		is_subject = no
	}

	is_triggered_only = yes

	option = { # very well
		name = ausgleich.new.100.a
		hidden_effect = {
			HUN = {
				country_event = {
					id = ausgleich.new.101
					days = 2
				}
			}
			country_event = {
				id = ausgleich.new.200
				days = 5
			}
		}
	}
}

### Hungary receives an invitation
country_event = {
	id = ausgleich.new.101
	immediate = { log = "[GetDateText]: [Root.GetName]: event ausgleich.new.101" }
	title = ausgleich.new.101.t
	desc = ausgleich.new.101.d

	is_triggered_only = yes

	option = { # we'll see what comes of this
		name = ausgleich.new.101.a
		hidden_effect = {
			AUS = {
				country_event = {
					id = ausgleich.new.102
					days = 2
				}
			}
		}
	}
}

### Hungary agrees to come
country_event = {
	id = ausgleich.new.102
	immediate = { log = "[GetDateText]: [Root.GetName]: event ausgleich.new.102" }
	title = ausgleich.new.102.t
	desc = ausgleich.new.102.d

	fire_only_once = yes
	is_triggered_only = yes

	option = { # we'll see what comes of this
		name = ausgleich.new.102.a
	}
}

### Invite not only Hungary?
country_event = {
	id = ausgleich.new.200
	title = ausgleich.new.200.t
	desc = ausgleich.new.200.d

	fire_only_once = yes
	is_triggered_only = yes

	immediate = {
		log = "[GetDateText]: [Root.GetName]: event ausgleich.new.200"
		hidden_effect = {
			country_event = {
				id = ausgleich.new.300
				days = 14
			}
		}
	}

	option = { # No way. This is between us and the Magyars.
		name = ausgleich.new.200.a
		ai_chance = {
			base = 10
			modifier = {
				factor = 0
				OR = {
					has_game_rule = {
						rule = AUS_ausgleich
						option = AUS_AUSGLEICH_FEDERATE_SUCCESS
					}
					has_game_rule = {
						rule = AUS_ausgleich
						option = AUS_AUSGLEICH_FEDERATE_CIVIL_WAR
					}
					has_game_rule = {
						rule = AUS_ausgleich
						option = AUS_AUSGLEICH_MILITARY_OCCUPATION
					}
				}
			}
		}

		add_political_power = 20
		set_global_flag = AUS_ausgleich_hungary_only
	}
	option = { # You are right. Invite the Bohemians, Galicians and Illyrians.
		name = ausgleich.new.200.b
		ai_chance = {
			base = 40
			modifier = {
				factor = 0
				has_game_rule = {
					rule = AUS_ausgleich
					option = AUS_AUSGLEICH_STATUS_QUO
				}
			}
		}

		add_political_power = -20
		set_global_flag = AUS_ausgleich_kingdoms
		hidden_effect = {
			HUN = {
				country_event = {
					id = ausgleich.new.201
					days = 2
				}
			}
			CZE = {
				country_event = {
					id = ausgleich.new.202
					days = 2
				}
			}
			GAL = {
				country_event = {
					id = ausgleich.new.202
					days = 2
				}
			}
			CRO = {
				country_event = {
					id = ausgleich.new.202
					days = 2
				}
			}
		}
	}
	option = { # You are right. Invite all peoples of the Dual Monarchy.
		name = ausgleich.new.200.c
		ai_chance = {
			base = 50
			modifier = {
				factor = 0
				has_game_rule = {
					rule = AUS_ausgleich
					option = AUS_AUSGLEICH_STATUS_QUO
				}
			}
		}

		add_political_power = -100
		set_global_flag = AUS_ausgleich_peoples
		hidden_effect = {
			HUN = {
				country_event = {
					id = ausgleich.new.201
					days = 2
				}
			}
			CZE = {
				country_event = {
					id = ausgleich.new.202
					days = 2
				}
			}
			GAL = {
				country_event = {
					id = ausgleich.new.202
					days = 2
				}
			}
			CRO = {
				country_event = {
					id = ausgleich.new.202
					days = 2
				}
			}
		}
	}
}

### HUN: Austria invites other delegations to the Ausgleich
country_event = {
	id = ausgleich.new.201
	immediate = { log = "[GetDateText]: [Root.GetName]: event ausgleich.new.201" }

	title = {
		text = ausgleich.new.201.t_kingdoms
		trigger = {
			has_global_flag = AUS_ausgleich_kingdoms
		}
	}
	title = {
		text = ausgleich.new.201.t_peoples
		trigger = {
			has_global_flag = AUS_ausgleich_peoples
		}
	}
	desc = {
		text = ausgleich.new.201.d_kingdoms
		trigger = {
			has_global_flag = AUS_ausgleich_kingdoms
		}
	}
	desc = {
		text = ausgleich.new.201.d_peoples
		trigger = {
			has_global_flag = AUS_ausgleich_peoples
		}
	}

	is_triggered_only = yes

	option = { # formally protest
		name = ausgleich.new.201.a
		ai_chance = {
			base = 100
			modifier = {
				factor = 0.6
				OR = {
					has_global_flag = AUS_ausgleich_kingdoms
					has_global_flag = AUS_ausgleich_peoples
				}
			}
		}

		#small opinion modifiers
		hidden_effect = {
			AUS = {
				country_event = {
					id = ausgleich.new.203
					days = 2
				}
			}
		}
	}
	option = { # boycott the ausgleich
		name = ausgleich.new.201.b
		ai_chance = {
			base = 100
			modifier = {
				factor = 0.1
				has_global_flag = AUS_ausgleich_kingdoms
			}
			modifier = {
				factor = 0.3
				has_global_flag = AUS_ausgleich_peoples
			}
		}

		#heavy opinion modifiers
		set_global_flag = AUS_ausgleich_boycott
		hidden_effect = {
			AUS = {
				country_event = {
					id = ausgleich.new.203
					days = 2
				}
			}
		}
	}
	option = { # do nothing
		name = ausgleich.new.201.c
		ai_chance = {
			base = 100
			modifier = {
				factor = 0.3
				has_global_flag = AUS_ausgleich_kingdoms
			}
			modifier = {
				factor = 0.15
				has_global_flag = AUS_ausgleich_peoples
			}
		}
	}
}

### BOH/CZE/GAL is invited to the Ausgleich
country_event = {
	id = ausgleich.new.202
	immediate = { log = "[GetDateText]: [Root.GetName]: event ausgleich.new.202" }
	title = ausgleich.new.202.t
	desc = ausgleich.new.202.d

	is_triggered_only = yes

	option = { # very good
		trigger = {
			has_global_flag = AUS_ausgleich_kingdoms
		}
		name = ausgleich.new.202.a
		#opinion modifier
		hidden_effect = {
			AUS = {
				country_event = {
					id = ausgleich.new.203
					days = 2
				}
			}
		}
	}
	option = { # Agree and send a mixed delegation
		name = ausgleich.new.202.b
		trigger = {
			has_global_flag = AUS_ausgleich_peoples
		}
		#opinion modifier
		set_country_flag = ausgleich_mixed_delegation
		hidden_effect = {
			AUS = {
				country_event = {
					id = ausgleich.new.203
					days = 2
				}
			}
		}
	}
	option = { # Send a majority-dominated delegation
		name = ausgleich.new.202.c
		trigger = {
			has_global_flag = AUS_ausgleich_peoples
		}
		#opinion modifier
		hidden_effect = {
			AUS = {
				country_event = {
					id = ausgleich.new.203
					days = 2
				}
			}
		}
	}
}

### Reactions to the invitations
country_event = {
	id = ausgleich.new.203
	immediate = { log = "[GetDateText]: [Root.GetName]: event ausgleich.new.203" }

	title = {
		text = ausgleich.new.203.t_HUN
		trigger = {
			FROM = {
				tag = HUN
			}
		}
	}
	title = {
		text = ausgleich.new.203.t_other
		trigger = {
			FROM = {
				NOT = {
					tag = HUN
				}
			}
		}
	}
	desc = {
		text = ausgleich.new.203.d_HUN
		trigger = {
			FROM = {
				tag = HUN
			}
		}
	}
	desc = {
		text = ausgleich.new.203.d_other
		trigger = {
			FROM = {
				NOT = {
					tag = HUN
				}
			}
		}
	}

	is_triggered_only = yes

	option = { # It's the way forward
		name = ausgleich.new.203.a
		trigger = {
			FROM = {
				tag = HUN
			}
		}
		add_political_power = -10
	}
	option = { # Excellent
		name = ausgleich.new.203.b
		trigger = {
			FROM = {
				NOT = {
					tag = HUN
				}
			}
		}
		add_political_power = 10
	}
}

#########################
### AUSGLEICH of 1937 ###
#########################

### Ausgleich begins
country_event = {
	id = ausgleich.new.300

	title = {
		text = ausgleich.new.300.t_hungary
		trigger = {
			has_global_flag = AUS_ausgleich_hungary_only
		}
	}
	title = {
		text = ausgleich.new.300.t_delegations_no_boycott
		trigger = {
			NOT = {
				has_global_flag = AUS_ausgleich_boycott
			}
			OR = {
				has_global_flag = AUS_ausgleich_kingdoms
				has_global_flag = AUS_ausgleich_peoples
			}
		}
	}
	title = {
		text = ausgleich.new.300.t_delegations_boycott
		trigger = {
			has_global_flag = AUS_ausgleich_boycott
			OR = {
				has_global_flag = AUS_ausgleich_kingdoms
				has_global_flag = AUS_ausgleich_peoples
			}
		}
	}

	desc = {
		text = ausgleich.new.300.d_hungary
		trigger = {
			has_global_flag = AUS_ausgleich_hungary_only
		}
	}
	desc = {
		text = ausgleich.new.300.d_delegations_no_boycott
		trigger = {
			NOT = {
				has_global_flag = AUS_ausgleich_boycott
			}
			OR = {
				has_global_flag = AUS_ausgleich_kingdoms
				has_global_flag = AUS_ausgleich_peoples
			}
		}
	}
	desc = {
		text = ausgleich.new.300.d_delegations_boycott
		trigger = {
			has_global_flag = AUS_ausgleich_boycott
			OR = {
				has_global_flag = AUS_ausgleich_kingdoms
				has_global_flag = AUS_ausgleich_peoples
			}
		}
	}

	is_triggered_only = yes

	immediate = {
		log = "[GetDateText]: [Root.GetName]: event ausgleich.new.300"
		hidden_effect = {
			complete_national_focus = AUS_ausgleich
		}
	}

	option = { # Excellent
		name = ausgleich.new.300.a
		trigger = {
			NOT = {
				has_global_flag = AUS_ausgleich_boycott
			}
		}
		add_political_power = 10
		hidden_effect = {
			country_event = {
				id = ausgleich.new.310
				days = 1
			}
		}
	}
	option = { # Excellent
		name = ausgleich.new.300.b
		trigger = {
			has_global_flag = AUS_ausgleich_boycott
		}
		add_political_power = 10
		hidden_effect = {
			country_event = {
				id = ausgleich.new.312
				days = 1
			}
		}
	}
}

### Hungarian delegate makes speech
country_event = {
	id = ausgleich.new.310
	title = ausgleich.new.310.t
	desc = ausgleich.new.310.d

	fire_only_once = yes
	is_triggered_only = yes

	immediate = {
		log = "[GetDateText]: [Root.GetName]: event ausgleich.new.310"
		hidden_effect = {
			country_event = {
				id = ausgleich.new.311
				days = 1
			}
		}
	}

	option = { # how insolent
		name = ausgleich.new.310.a
		ai_chance = {
			base = 5
		}
	}
	option = { # send him home
		name = ausgleich.new.310.b
		ai_chance = {
			base = 5
			modifier = {
				factor = 0
				has_game_rule = {
					rule = AUS_ausgleich
					option = AUS_AUSGLEICH_STATUS_QUO
				}
			}
		}
		set_country_flag = ausgleich_HUN_delegate_sent_home
		if = {
			limit = {
				has_global_flag = AUS_ausgleich_kingdoms
			}
			add_political_power = 15
		}
		else_if = {
			limit = {
				has_global_flag = AUS_ausgleich_peoples
			}
			add_political_power = 30
		}
	}
	option = { # he's right though, isn't he?
		name = ausgleich.new.310.c
		ai_chance = {
			base = 5
			modifier = {
				factor = 0
				OR = {
					has_game_rule = {
						rule = AUS_ausgleich
						option = AUS_AUSGLEICH_STATUS_QUO
					}
					has_game_rule = {
						rule = AUS_ausgleich
						option = AUS_AUSGLEICH_FEDERATE_SUCCESS
					}
					has_game_rule = {
						rule = AUS_ausgleich
						option = AUS_AUSGLEICH_FEDERATE_CIVIL_WAR
					}
					has_game_rule = {
						rule = AUS_ausgleich
						option = AUS_AUSGLEICH_MILITARY_OCCUPATION
					}
				}
			}
		}
		if = {
			limit = {
				has_global_flag = AUS_ausgleich_kingdoms
			}
			add_political_power = -15
		}
		else_if = {
			limit = {
				has_global_flag = AUS_ausgleich_peoples
			}
			add_political_power = -30
		}
		else_if = {
			limit = {
				has_global_flag = AUS_ausgleich_hungary_only
			}
			set_country_flag = AUS_ausgleich_dualism
		}
	}
}

country_event = { #Hungarian Demands - Reparation Payments
	id = ausgleich.new.311
	title = ausgleich.new.311.t
	desc = ausgleich.new.311.d

	fire_only_once = yes
	is_triggered_only = yes

	immediate = {
		log = "[GetDateText]: [Root.GetName]: event ausgleich.new.311"
		hidden_effect = {
			if = {
				limit = {
					has_global_flag = AUS_ausgleich_hungary_only
				}
				country_event = {
					id = ausgleich.new.320
					days = 1
				}
			}
			else = {
				country_event = {
					id = ausgleich.new.312
					days = 1
				}
			}
		}
	}

	option = { # offer to pay from your own coffers
		name = ausgleich.new.311.a
		ai_chance = {
			base = 5
		}

		set_global_flag = AUS_ausgleich_austrian_payments
	}
	option = { # the Illyrians should pay (absent)
		name = ausgleich.new.311.b
		trigger = {
			has_global_flag = AUS_ausgleich_hungary_only
		}
		ai_chance = {
			base = 15
		}

		set_global_flag = AUS_ausgleich_illyrian_payments
		set_global_flag = AUS_ausgleich_absent_demands
	}
	option = { # the Illyrians should pay (present)
		name = ausgleich.new.311.c
		trigger = {
			OR = {
				has_global_flag = AUS_ausgleich_kingdoms
				has_global_flag = AUS_ausgleich_peoples
			}
		}
		ai_chance = {
			base = 15
		}

		set_global_flag = AUS_ausgleich_illyrian_payments
	}
	option = { # point out that they pay less taxes
		name = ausgleich.new.311.e
		ai_chance = {
			base = 80
		}
	}
	option = { # secretly offer them to take back Croatia
		name = ausgleich.new.311.f
		trigger = {
			has_country_flag = AUS_ausgleich_dualism
		}
		ai_chance = {
			base = 1
			modifier = {
				factor = 0
				has_game_rule = {
					rule = AUS_ausgleich
					option = AUS_AUSGLEICH_STATUS_QUO
				}
			}
		}

		set_global_flag = AUS_ausgleich_secret_deal
	}
}

#CZE Demands - Slovakia
country_event = {
	id = ausgleich.new.312
	title = ausgleich.new.312.t
	desc = ausgleich.new.312.d

	fire_only_once = yes
	is_triggered_only = yes

	immediate = {
		log = "[GetDateText]: [Root.GetName]: event ausgleich.new.312"
		if = {
			limit = {
				has_global_flag = AUS_ausgleich_peoples
			}
			hidden_effect = {
				country_event = {
					id = ausgleich.new.315
					days = 1
				}
			}
		}
		else = {
			hidden_effect = {
				country_event = {
					id = ausgleich.new.313
					days = 1
				}
			}
		}
	}

	option = { #Ask Hungary
		name = ausgleich.new.312.a
		trigger = {
			NOT = {
				has_global_flag = AUS_ausgleich_boycott
			}
		}
		ai_chance = {
			base = 33
			modifier = {
				factor = 0
				OR = {
					has_game_rule = {
						rule = AUS_ausgleich
						option = AUS_AUSGLEICH_FEDERATE_SUCCESS
					}
					has_game_rule = {
						rule = AUS_ausgleich
						option = AUS_AUSGLEICH_FEDERATE_CIVIL_WAR
					}
					has_game_rule = {
						rule = AUS_ausgleich
						option = AUS_AUSGLEICH_MILITARY_OCCUPATION
					}
				}
			}
		}
	}
	option = { # Let's do this - Slovak majority territory
		name = ausgleich.new.312.b
		ai_chance = {
			base = 33
		}

		set_global_flag = AUS_ausgleich_slovakia
		if = {
			limit = {
				NOT = {
					has_global_flag = AUS_ausgleich_boycott
				}
			}
			country_event = ausgleich.new.317
			set_global_flag = AUS_ausgleich_boycott
		}
		SVK = {
			remove_state_core = 664
			add_state_claim = 664
		}
	}
	option = { # Let's do this - down to the Danube
		name = ausgleich.new.312.c
		trigger = {
			has_global_flag = AUS_ausgleich_boycott
		}
		ai_chance = {
			base = 33
		}

		set_global_flag = AUS_ausgleich_slovakia
	}
}

#GAL demands - Transcarpathia
country_event = {
	id = ausgleich.new.313
	title = ausgleich.new.313.t
	desc = ausgleich.new.313.d

	fire_only_once = yes
	is_triggered_only = yes

	immediate = {
		log = "[GetDateText]: [Root.GetName]: event ausgleich.new.313"
		hidden_effect = {
			country_event = {
				id = ausgleich.new.314
				days = 1
			}
		}
	}

	option = { #Ask Hungary
		name = ausgleich.new.313.a
		trigger = {
			NOT = {
				has_global_flag = AUS_ausgleich_boycott
			}
		}
		ai_chance = {
			base = 33
			modifier = {
				factor = 0
				OR = {
					has_game_rule = {
						rule = AUS_ausgleich
						option = AUS_AUSGLEICH_FEDERATE_SUCCESS
					}
					has_game_rule = {
						rule = AUS_ausgleich
						option = AUS_AUSGLEICH_FEDERATE_CIVIL_WAR
					}
					has_game_rule = {
						rule = AUS_ausgleich
						option = AUS_AUSGLEICH_MILITARY_OCCUPATION
					}
				}
			}
		}
	}
	option = { # Let's do this
		name = ausgleich.new.313.b
		ai_chance = {
			base = 33
		}

		set_global_flag = AUS_ausgleich_transcarpathia
		GAL = {
			add_state_core = 73
		}
		if = {
			limit = {
				NOT = {
					has_global_flag = AUS_ausgleich_boycott
				}
			}
			country_event = ausgleich.new.317
			set_global_flag = AUS_ausgleich_boycott
		}
	}
}

#CRO demands - Backa
country_event = {
	id = ausgleich.new.314
	title = ausgleich.new.314.t
	desc = ausgleich.new.314.d

	fire_only_once = yes
	is_triggered_only = yes

	immediate = {
		log = "[GetDateText]: [Root.GetName]: event ausgleich.new.314"
		if = {
			limit = {
				has_global_flag = AUS_ausgleich_peoples
			}
			hidden_effect = {
				country_event = {
					id = ausgleich.new.316
					days = 1
				}
			}
		}
		else = {
			hidden_effect = {
				country_event = {
					id = ausgleich.new.320
					days = 1
				}
			}
		}
	}

	option = { #Ask Hungary
		name = ausgleich.new.314.a
		trigger = {
			NOT = {
				has_global_flag = AUS_ausgleich_boycott
			}
		}
		ai_chance = {
			base = 33
			modifier = {
				factor = 0
				OR = {
					has_game_rule = {
						rule = AUS_ausgleich
						option = AUS_AUSGLEICH_FEDERATE_SUCCESS
					}
					has_game_rule = {
						rule = AUS_ausgleich
						option = AUS_AUSGLEICH_FEDERATE_CIVIL_WAR
					}
					has_game_rule = {
						rule = AUS_ausgleich
						option = AUS_AUSGLEICH_MILITARY_OCCUPATION
					}
				}
			}
		}
	}
	option = { # Let's do this - Majority territory
		name = ausgleich.new.314.b
		ai_chance = {
			base = 33
		}

		set_global_flag = AUS_ausgleich_backa
		CRO = {
			add_state_core = 45
		}
		if = {
			limit = {
				NOT = {
					has_global_flag = AUS_ausgleich_boycott
				}
			}
			country_event = ausgleich.new.317
			set_global_flag = AUS_ausgleich_boycott
		}
	}
	option = { # Let's do this - All of the Backa
		name = ausgleich.new.314.c
		trigger = {
			has_global_flag = AUS_ausgleich_boycott
		}
		ai_chance = {
			base = 33
		}

		set_global_flag = AUS_ausgleich_backa
		CRO = {
			add_state_core = 45
			add_state_core = 875
		}
	}
}

#POL demands
country_event = {
	id = ausgleich.new.315
	title = ausgleich.new.315.t
	desc = ausgleich.new.315.d

	fire_only_once = yes
	is_triggered_only = yes

	immediate = {
		log = "[GetDateText]: [Root.GetName]: event ausgleich.new.315"
		hidden_effect = {
			country_event = {
				id = ausgleich.new.313
				days = 1
			}
		}
	}

	option = { # Interesting
		name = ausgleich.new.315.a
	}
}

#ROM demands
country_event = {
	id = ausgleich.new.316
	title = ausgleich.new.316.t
	desc = ausgleich.new.316.d

	fire_only_once = yes
	is_triggered_only = yes

	immediate = {
		log = "[GetDateText]: [Root.GetName]: event ausgleich.new.316"
		hidden_effect = {
			country_event = {
				id = ausgleich.new.320
				days = 1
			}
		}
	}

	option = { # Ask Hungary
		name = ausgleich.new.316.a
		trigger = {
			NOT = {
				has_global_flag = AUS_ausgleich_boycott
			}
		}
		ai_chance = {
			base = 33
			modifier = {
				factor = 0
				OR = {
					has_game_rule = {
						rule = AUS_ausgleich
						option = AUS_AUSGLEICH_FEDERATE_SUCCESS
					}
					has_game_rule = {
						rule = AUS_ausgleich
						option = AUS_AUSGLEICH_FEDERATE_CIVIL_WAR
					}
				}
			}
		}
	}
	option = { # Let's do this - Majority territory
		name = ausgleich.new.316.b
		ai_chance = {
			base = 33
		}

		set_global_flag = AUS_ausgleich_transylvania
		TRS = {
			add_state_core = 82
			add_state_core = 83
			add_state_core = 84
			if = {
				limit = {
					875 = {
						NOT = {
							is_core_of = CRO
						}
					}
				}
				add_state_core = 875
			}
		}
		if = {
			limit = {
				NOT = {
					has_global_flag = AUS_ausgleich_boycott
				}
			}
			country_event = ausgleich.new.317
			set_global_flag = AUS_ausgleich_boycott
		}
	}
	option = { # Let's do this - All of it
		name = ausgleich.new.316.c
		trigger = {
			has_global_flag = AUS_ausgleich_boycott
		}
		ai_chance = {
			base = 33
		}

		set_global_flag = AUS_ausgleich_transylvania
		TRS = {
			add_state_core = 76
			add_state_core = 82
			add_state_core = 83
			add_state_core = 84
			add_state_core = 789
			if = {
				limit = {
					NOT = {
						875 = {
							is_core_of = CRO
						}
					}
				}
				add_state_core = 875
			}
		}
	}
}

#Hungary boycotts the ausgleich (AUS)
country_event = {
	id = ausgleich.new.317
	title = ausgleich.new.317.t
	desc = ausgleich.new.317.d

	fire_only_once = yes
	is_triggered_only = yes

	immediate = {
		log = "[GetDateText]: [Root.GetName]: event ausgleich.new.317"
		hidden_effect = {
			HUN = {
				country_event = {
					id = ausgleich.new.318
					days = 2
				}
			}
		}
	}

	option = { # That could've gone better
		name = ausgleich.new.317.a
		add_political_power = -50
		set_global_flag = AUS_ausgleich_boycott
	}
}

#Hungary boycotts the ausgleich (HUN)
country_event = {
	id = ausgleich.new.318
	immediate = { log = "[GetDateText]: [Root.GetName]: event ausgleich.new.318" }
	title = ausgleich.new.318.t
	desc = ausgleich.new.318.d

	fire_only_once = yes
	is_triggered_only = yes

	option = { # Good to know.
		name = ausgleich.new.318.a
	}
}

###End of the Ausgleich
country_event = {
	id = ausgleich.new.320
	title = ausgleich.new.320.t

	desc = {
		text = ausgleich.new.320.d_hungary_success
		trigger = {
			has_global_flag = AUS_ausgleich_hungary_only
			NOT = {
				has_global_flag = AUS_ausgleich_boycott
			}
		}
	}
	desc = {
		text = ausgleich.new.320.d_hungary_failure
		trigger = {
			has_global_flag = AUS_ausgleich_hungary_only
			has_global_flag = AUS_ausgleich_boycott
		}
	}
	desc = {
		text = ausgleich.new.320.d_other_success
		trigger = {
			OR = {
				has_global_flag = AUS_ausgleich_kingdoms
				has_global_flag = AUS_ausgleich_peoples
			}
			NOT = {
				has_global_flag = AUS_ausgleich_boycott
			}
		}
	}
	desc = {
		text = ausgleich.new.320.d_other_failure
		trigger = {
			OR = {
				has_global_flag = AUS_ausgleich_kingdoms
				has_global_flag = AUS_ausgleich_peoples
			}
			has_global_flag = AUS_ausgleich_boycott
		}
	}

	fire_only_once = yes
	is_triggered_only = yes

	immediate = {
		log = "[GetDateText]: [Root.GetName]: event ausgleich.new.320"
		hidden_effect = {
			if = {
				limit = {
					has_global_flag = AUS_ausgleich_secret_deal
				}
				HUN = {
					country_event = {
						id = ausgleich.new.325 #Illyrian Conflict
						days = 1
					}
				}
			}
			else_if = {
				limit = {
					OR = {
						has_global_flag = AUS_ausgleich_illyrian_payments
						has_global_flag = AUS_ausgleich_austrian_payments
					}
				}
				HUN = {
					country_event = {
						id = ausgleich.new.322 #Payments
						days = 1
					}
				}
			}
			else_if = {
				limit = {
					OR = {
						has_global_flag = AUS_ausgleich_backa
						has_global_flag = AUS_ausgleich_transcarpathia
						has_global_flag = AUS_ausgleich_transylvania
						has_global_flag = AUS_ausgleich_slovakia
					}
				}
				CZE = {
					country_event = {
						id = ausgleich.new.332
						days = 5
					}
				}
				GAL = {
					country_event = {
						id = ausgleich.new.332
						days = 5
					}
				}
				CRO = {
					country_event = {
						id = ausgleich.new.332
						days = 5
					}
				}
				HUN = {
					country_event = {
						id = ausgleich.new.340 #Riots
						days = 5
					}
				}
			}
		}
	}

	option = { # Great
		name = ausgleich.new.320.a
		trigger = {
			NOT = {
				has_global_flag = AUS_ausgleich_boycott
			}
		}
		remove_ideas = AUS_financial_ties_broken
		add_political_power = 50
		hidden_effect = {
			HUN = {
				country_event = {
					id = ausgleich.new.321 #Success
					days = 1
				}
			}
		}
	}
	option = { # Could have been worse...
		name = ausgleich.new.320.b
		trigger = {
			has_global_flag = AUS_ausgleich_boycott
		}
		add_political_power = -50
	}
}

#Success at the Ausgleich (HUN)
country_event = {
	id = ausgleich.new.321
	immediate = { log = "[GetDateText]: [Root.GetName]: event ausgleich.new.321" }
	title = ausgleich.new.321.t
	desc = ausgleich.new.321.d

	fire_only_once = yes
	is_triggered_only = yes

	option = { # Well, what can you do
		name = ausgleich.new.321.a

		swap_ideas = {
			remove_idea = HUN_financial_ties_broken
			add_idea = HUN_financial_ties
		}
	}
}

#HUN demands payments
country_event = {
	id = ausgleich.new.322
	title = ausgleich.new.322.t
	desc = ausgleich.new.322.d

	fire_only_once = yes
	is_triggered_only = yes

	immediate = {
		log = "[GetDateText]: [Root.GetName]: event ausgleich.new.322"
		if = {
			limit = {
				has_global_flag = AUS_ausgleich_illyrian_payments
				has_global_flag = AUS_ausgleich_absent_demands
			}
			CRO = {
				country_event = {
					id = ausgleich.new.325
					days = 2
				}
			}
		}
		else_if = {
			limit = {
				has_global_flag = AUS_ausgleich_illyrian_payments
				NOT = {
					has_global_flag = AUS_ausgleich_absent_demands
				}
			}
			CRO = {
				country_event = {
					id = ausgleich.new.323
					days = 2
				}
			}
		}
		else = {
			AUS = {
				country_event = {
					id = ausgleich.new.323
					days = 2
				}
			}
		}
	}

	option = { # Send the demands
		name = ausgleich.new.322.a
	}
}

#AUS/CRO receives demand for agreed payments
country_event = {
	id = ausgleich.new.323
	title = ausgleich.new.323.t
	desc = ausgleich.new.323.d

	fire_only_once = yes
	is_triggered_only = yes

	immediate = {
		log = "[GetDateText]: [Root.GetName]: event ausgleich.new.323"
		hidden_effect = {
			HUN = {
				country_event = {
					id = ausgleich.new.324
					days = 2
				}
			}
		}
	}

	option = { # Well, can't do a thing.
		name = ausgleich.new.323.a
		add_timed_idea = {
			idea = AUS_paid_reparations
			days = 365
		}
	}
}

#HUN receives reparations
country_event = {
	id = ausgleich.new.324
	immediate = { log = "[GetDateText]: [Root.GetName]: event ausgleich.new.324" }
	title = ausgleich.new.324.t
	desc = ausgleich.new.324.d

	fire_only_once = yes
	is_triggered_only = yes

	option = { # Good to know.
		name = ausgleich.new.324.a
	}
}

###Illyrian Conflict (CRO)
country_event = {
	id = ausgleich.new.325
	immediate = { log = "[GetDateText]: [Root.GetName]: event ausgleich.new.325" }
	title = ausgleich.new.325.t
	desc = ausgleich.new.325.d

	fire_only_once = yes
	is_triggered_only = yes

	option = { # Wait, what?
		name = ausgleich.new.325.a
		ai_chance = {
			factor = 80
		}

		hidden_effect = {
			HUN = {
				country_event = {
					id = ausgleich.new.326
					days = 2
				}
			}
		}
	}
	option = { # If that has been decided...
		name = ausgleich.new.325.b
		ai_chance = {
			factor = 20
			modifier = {
				factor = 0
				has_global_flag = AUS_ausgleich_secret_deal
			}
		}

		add_timed_idea = {
			idea = AUS_paid_reparations
			days = 365
		}
		hidden_effect = {
			HUN = {
				country_event = {
					id = ausgleich.new.323
					days = 2
				}
			}
		}
	}
}

#CRO refuses annexation (HUN)
country_event = {
	id = ausgleich.new.326
	immediate = { log = "[GetDateText]: [Root.GetName]: event ausgleich.new.326" }
	title = ausgleich.new.326.t
	desc = ausgleich.new.326.d

	fire_only_once = yes
	is_triggered_only = yes

	option = { # Well, let's do this then
		name = ausgleich.new.326.a
		ai_chance = {
			factor = 90
		}

		hidden_effect = {
			AUS = {
				set_autonomy = {
					target = CRO
					autonomy_state = autonomy_free
				}
				country_event = {
					id = ausgleich.new.328
					days = 1
				}
			}
			CRO = {
				separate_peace_all_wars = yes
				leave_faction = yes
				country_event = ausgleich.new.327
			}
			load_oob = HUN_AUS_Civil_war
		}
		custom_effect_tooltip = "Ten new militia divisions will be formed"
		declare_war_on = {
			target = CRO
			type = annex_everything
		}
	}
	option = { # Well, can't do anything about it
		name = ausgleich.new.326.b
		ai_chance = {
			factor = 10
		}
	}
}

#HUN declares war (CRO)
country_event = {
	id = ausgleich.new.327
	immediate = { log = "[GetDateText]: [Root.GetName]: event ausgleich.new.327" }
	title = ausgleich.new.327.t
	desc = ausgleich.new.327.d

	fire_only_once = yes
	is_triggered_only = yes

	option = { # Crap.
		name = ausgleich.new.327.a
	}
}

#HUN declares war (AUS)
country_event = {
	id = ausgleich.new.328
	title = ausgleich.new.328.t
	desc = ausgleich.new.328.d

	immediate = {
		log = "[GetDateText]: [Root.GetName]: event ausgleich.new.328"
		set_global_flag = AUS_illyrian_war
	}

	fire_only_once = yes
	is_triggered_only = yes

	option = { # This is outrageous.
		name = ausgleich.new.328.a
		hidden_effect = {
			AUS = {
				set_autonomy = {
					target = CRO
					autonomy_state = kr_integrated_puppet
				}
				set_autonomy = {
					target = HUN
					autonomy_state = autonomy_free
				}
			}
		}
		add_to_war = {
			targeted_alliance = CRO
			enemy = HUN
		}
	}
	option = { # Leave them to it
		name = ausgleich.new.328.b
		trigger = {
			NOT = {
				has_global_flag = AUS_ausgleich_secret_deal
			}
		}
		add_political_power = -200
	}
	option = { # It's happening
		name = ausgleich.new.328.c
		trigger = {
			has_global_flag = AUS_ausgleich_secret_deal
		}
		set_country_flag = CRO_release
		set_global_flag = AUS_illyrian_war
		set_global_flag = AUS_betrayal
		add_to_war = {
			targeted_alliance = HUN
			enemy = CRO
		}
		hidden_effect = {
			CZE = {
				country_event = {
					id = ausgleich.new.329
					days = 6
				}
			}
			GAL = {
				country_event = {
					id = ausgleich.new.329
					days = 6
				}
			}
		}
	}
}

#CZE/GAL notified of Austrian betrayal
country_event = {
	id = ausgleich.new.329
	immediate = { log = "[GetDateText]: [Root.GetName]: event ausgleich.new.329" }
	title = ausgleich.new.329.t
	desc = ausgleich.new.329.d

	trigger = {
		is_subject_of = AUS
		has_global_flag = AUS_illyrian_war
		has_global_flag = AUS_betrayal
		AUS = {
			has_war_with = CRO
		}
	}

	is_triggered_only = yes

	option = { # How dare they!
		name = ausgleich.new.329.a

		hidden_effect = {
			AUS = {
				set_autonomy = {
					target = ROOT
					autonomy_state = autonomy_free
				}
			}
			separate_peace_all_wars = yes
			leave_faction = yes
		}
		add_to_war = {
			targeted_alliance = CRO
			enemy = AUS
		}
	}
}

#CRO annexation mission
country_event = {
	id = ausgleich.new.330
	immediate = { log = "[GetDateText]: [Root.GetName]: event ausgleich.new.330" }
	title = ausgleich.new.330.t
	desc = ausgleich.new.330.d

	is_triggered_only = yes

	option = { # Restore the 1921 borders
		name = ausgleich.new.330.a

		transfer_state = 163
		HUN = {
			transfer_state = 103
			transfer_state = 109
			transfer_state = 794
		}
		BOS = {
			add_state_core = 104
			transfer_state = 104
			add_ideas = AUS_part_of_the_Empire
		}
		set_autonomy = {
			target = BOS
			autonomy_state = kr_integrated_puppet
		}
		MTN = {
			transfer_state = 105
			add_ideas = AUS_part_of_the_Empire
		}
		set_autonomy = {
			target = MTN
			autonomy_state = kr_integrated_puppet
		}
	}
	option = { # Croatia-Slavonia to Hungary, Illyrian Condominium
		name = ausgleich.new.330.b

		HUN = {
			transfer_state = 103
			transfer_state = 109
			transfer_state = 794
		}
		CRO = {
			add_state_core = 104
			add_state_core = 105
			add_state_core = 163
			transfer_state = 104
			transfer_state = 105
			transfer_state = 163
			add_ideas = AUS_part_of_the_Empire
			set_cosmetic_tag = CRO_ILL
		}
		set_autonomy = {
			target = CRO
			autonomy_state = kr_integrated_puppet
		}
	}
	option = { # Occupy the whole thing for now
		name = ausgleich.new.330.c

		transfer_state = 103
		transfer_state = 104
		transfer_state = 105
		transfer_state = 109
		transfer_state = 163
		transfer_state = 794
		HUN = {
			country_event = {
				id = ausgleich.new.331
				days = 2
			}
		}
	}
}

#Austria breaks secret deal (HUN)
country_event = {
	id = ausgleich.new.331
	immediate = { log = "[GetDateText]: [Root.GetName]: event ausgleich.new.331" }
	title = ausgleich.new.331.t
	desc = ausgleich.new.331.d

	fire_only_once = yes
	is_triggered_only = yes

	option = { # They can't do that!
		name = ausgleich.new.331.a
		ai_chance = {
			factor = 100
		}
		hidden_effect = {
			AUS = {
				set_autonomy = {
					target = HUN
					autonomy_state = autonomy_free
				}
			}
			separate_peace_all_wars = yes
			leave_faction = yes
			load_oob = HUN_AUS_Civil_war
		}
		custom_effect_tooltip = "Ten new militia divisions will be formed"
		declare_war_on = {
			target = AUS
			type = annex_everything
		}
		country_event = kr.hungary.2
	}
	option = { # well shit.
		name = ausgleich.new.331.b
		ai_chance = {
			factor = 0
		}
		add_political_power = -100
	}
}

#Notify Ausgleich results to CZE/GAL/CRO
country_event = {
	id = ausgleich.new.332
	immediate = { log = "[GetDateText]: [Root.GetName]: event ausgleich.new.332" }
	title = ausgleich.new.332.t

	desc = {
		text = ausgleich.new.332.d_no_claims
		trigger = {
			OR = {
				AND = {
					tag = CZE
					NOT = {
						has_global_flag = AUS_ausgleich_slovakia
					}
				}
				AND = {
					tag = GAL
					NOT = {
						has_global_flag = AUS_ausgleich_transcarpathia
					}
				}
				AND = {
					tag = CRO
					NOT = {
						has_global_flag = AUS_ausgleich_backa
					}
				}
			}
		}
	}
	desc = {
		text = ausgleich.new.332.d_claims
		trigger = {
			OR = {
				AND = {
					tag = CZE
					has_global_flag = AUS_ausgleich_slovakia
				}
				AND = {
					tag = GAL
					has_global_flag = AUS_ausgleich_transcarpathia
				}
				AND = {
					tag = CRO
					has_global_flag = AUS_ausgleich_backa
				}
			}
		}
	}

	fire_only_once = yes
	is_triggered_only = yes

	option = { # Certainly a valuable lesson for them.
		name = ausgleich.new.332.a
		trigger = {
			OR = {
				AND = {
					tag = CZE
					NOT = {
						has_global_flag = AUS_ausgleich_slovakia
					}
				}
				AND = {
					tag = GAL
					NOT = {
						has_global_flag = AUS_ausgleich_transcarpathia
					}
				}
				AND = {
					tag = CRO
					NOT = {
						has_global_flag = AUS_ausgleich_backa
					}
				}
			}
		}
	}
	option = { # Great!
		name = ausgleich.new.332.a
		trigger = {
			OR = {
				AND = {
					tag = CZE
					has_global_flag = AUS_ausgleich_slovakia
				}
				AND = {
					tag = GAL
					has_global_flag = AUS_ausgleich_transcarpathia
				}
				AND = {
					tag = CRO
					has_global_flag = AUS_ausgleich_backa
				}
			}
		}

		add_political_power = 100
		if = {
			limit = {
				tag = CZE
			}
			add_ideas = BOM_ausgleich_slovak_state
		}
		else_if = {
			limit = {
				tag = GAL
			}
			add_ideas = GAL_ausgleich_transcarpathian_claims
		}
		else = {
			add_ideas = ILL_ausgleich_backan_claims
		}
	}
}

### Austrian Civil War
#Demonstrations in Hungary
country_event = {
	id = ausgleich.new.340
	title = ausgleich.new.340.t
	desc = ausgleich.new.340.d

	fire_only_once = yes
	is_triggered_only = yes

	immediate = {
		log = "[GetDateText]: [Root.GetName]: event ausgleich.new.340"
		hidden_effect = {
			AUS = {
				country_event = {
					id = ausgleich.new.341
					days = 4
				}
			}
		}
	}

	option = { # Good to know.
		name = ausgleich.new.340.a
		if = {
			limit = {
				has_global_flag = AUS_ausgleich_slovakia
			}
			add_timed_idea = {
				idea = HUN_slovak_demonstrations
				days = 365
			}
		}
		if = {
			limit = {
				has_global_flag = AUS_ausgleich_transylvania
			}
			add_timed_idea = {
				idea = HUN_transylvanian_demonstrations
				days = 365
			}
		}
	}
}

#Protests put down violently (AUS)
country_event = {
	id = ausgleich.new.341
	immediate = { log = "[GetDateText]: [Root.GetName]: event ausgleich.new.341" }
	title = ausgleich.new.341.t
	desc = ausgleich.new.341.d

	fire_only_once = yes
	is_triggered_only = yes

	option = { # Demand the Hungarians cede the territories
		name = ausgleich.new.341.a
		ai_chance = {
			factor = 50
		}
		HUN = {
			set_country_flag = hungarian_protests

			country_event = {
				id = ausgleich.new.342
				days = 4
			}
		}
	}
	option = { # do nothing
		name = ausgleich.new.341.b
		ai_chance = {
			factor = 50
			modifier = {
				factor = 0
				OR = {
					has_game_rule = {
						rule = AUS_ausgleich
						option = AUS_AUSGLEICH_FEDERATE_SUCCESS
					}
					has_game_rule = {
						rule = AUS_ausgleich
						option = AUS_AUSGLEICH_FEDERATE_CIVIL_WAR
					}
					has_game_rule = {
						rule = AUS_ausgleich
						option = AUS_AUSGLEICH_MILITARY_OCCUPATION
					}
				}
			}
		}
		if = {
			limit = {
				has_global_flag = AUS_ausgleich_slovakia
				has_global_flag = AUS_ausgleich_transylvania
			}
			add_political_power = -120
		}
		else = {
			add_political_power = -60
		}
	}
}

#Austrian ultimatum (HUN)
country_event = {
	id = ausgleich.new.342
	immediate = { log = "[GetDateText]: [Root.GetName]: event ausgleich.new.342" }
	title = ausgleich.new.342.t
	desc = ausgleich.new.342.d

	fire_only_once = yes
	is_triggered_only = yes

	option = { # Do as they say.
		name = ausgleich.new.342.a
		ai_chance = {
			factor = 5
			modifier = {
				factor = 0
				OR = {
					has_game_rule = {
						rule = AUS_ausgleich
						option = AUS_AUSGLEICH_FEDERATE_CIVIL_WAR
					}
					has_game_rule = {
						rule = AUS_ausgleich
						option = AUS_AUSGLEICH_MILITARY_OCCUPATION
					}
				}
			}
		}

		add_political_power = -100
		AUS = {
			country_event = {
				id = ausgleich.new.343
				days = 1
			}
		}
	}
	option = { # No way.
		name = ausgleich.new.342.b
		ai_chance = {
			factor = 95
			modifier = {
				factor = 0
				has_game_rule = {
					rule = AUS_ausgleich
					option = AUS_AUSGLEICH_FEDERATE_SUCCESS
				}
			}
		}

		AUS = {
			country_event = {
				id = ausgleich.new.344
				days = 1
			}
		}
	}
}

#Hungary accepts ultimatum (AUS)
country_event = {
	id = ausgleich.new.343
	immediate = { log = "[GetDateText]: [Root.GetName]: event ausgleich.new.343" }
	title = ausgleich.new.343.t
	desc = ausgleich.new.343.d

	fire_only_once = yes
	is_triggered_only = yes

	option = { # Great.
		name = ausgleich.new.343.a
		set_country_flag = AUS_a_new_Hungary
		if = {
			limit = {
				has_global_flag = AUS_ausgleich_transcarpathia
			}
			HUN = {
				remove_state_core = 73
			}
			GAL = {
				transfer_state = 73
			}
		}
		if = {
			limit = {
				has_global_flag = AUS_ausgleich_backa
			}
			HUN = {
				every_owned_state = {
					limit = { is_core_of = CRO }
					remove_core_of = HUN
					CRO = {
						transfer_state = PREV
					}
				}
			}
		}
		if = {
			limit = {
				has_global_flag = AUS_ausgleich_slovakia
			}
			HUN = {
				every_owned_state = {
					limit = { is_core_of = SVK }
					remove_core_of = HUN
					ROOT = {
						transfer_state = PREV
					}
				}
				remove_ideas = HUN_slovak_demonstrations
			}
		}
		if = {
			limit = {
				has_global_flag = AUS_ausgleich_transylvania
			}
			HUN = {
				every_owned_state = {
					limit = { is_core_of = TRS }
					remove_core_of = HUN
					ROOT = {
						transfer_state = PREV
					}
				}
				remove_ideas = HUN_transylvanian_demonstrations
			}
		}
	}
}

#Hungary refuses ultimatum (AUS)
country_event = {
	id = ausgleich.new.344
	immediate = { log = "[GetDateText]: [Root.GetName]: event ausgleich.new.344" }
	title = ausgleich.new.344.t
	desc = ausgleich.new.344.d

	fire_only_once = yes
	is_triggered_only = yes

	option = { # you know what this means!
		name = ausgleich.new.344.a
		ai_chance = {
			factor = 95
		}
		hidden_effect = {
			HUN = {
				separate_peace_all_wars = yes
				leave_faction = yes
				load_oob = HUN_AUS_Civil_war
				swap_ideas = {
					remove_idea = HUN_financial_ties
					add_idea = HUN_financial_ties_broken
				}
				country_event = kr.hungary.2
			}
			set_autonomy = {
				target = HUN
				autonomy_state = autonomy_free
			}
		}
		declare_war_on = {
			target = HUN
			type = annex_everything
		}
		CZE = {
			add_to_war = {
				targeted_alliance = AUS
				enemy = HUN
			}
		}
		GAL = {
			add_to_war = {
				targeted_alliance = AUS
				enemy = HUN
			}
		}
		CRO = {
			add_to_war = {
				targeted_alliance = AUS
				enemy = HUN
			}
		}
	}

	option = { # oh well.
		name = ausgleich.new.344.b
		ai_chance = {
			factor = 5
			modifier = {
				factor = 0
				OR = {
					has_game_rule = {
						rule = AUS_ausgleich
						option = AUS_AUSGLEICH_FEDERATE_CIVIL_WAR
					}
					has_game_rule = {
						rule = AUS_ausgleich
						option = AUS_AUSGLEICH_MILITARY_OCCUPATION
					}
				}
			}
		}
		add_political_power = -40
	}
}

#Slovakia release mission
country_event = { #creation of Slovakia?
	id = ausgleich.new.345
	title = ausgleich.new.345.t
	desc = ausgleich.new.345.d

	is_triggered_only = yes
	
	immediate = {
		log = "[GetDateText]: [Root.GetName]: event ausgleich.new.345"
	}

	option = { #yes
		name = ausgleich.new.345.a
		ai_chance = {
			factor = 99
			modifier = {
				factor = 0
				has_game_rule = {
					rule = AUS_ausgleich
					option = AUS_AUSGLEICH_MILITARY_OCCUPATION
				}
			}
			modifier = {
				factor = 0
				has_country_flag = AUS_transylvania_occupied
			}
		}

		hidden_effect = {
			every_owned_state = {
				limit = {
					is_core_of = SVK
					NOT = { state = 664 }
				}
				HUN = {
					remove_state_core = PREV
				}
			}
		}
		if = {
			limit = {
				owns_state = 73
				GAL = {
					is_subject_of = ROOT
				}
				73 = {
					is_owned_by = ROOT
					is_core_of = GAL
				}
			}
			SVK = {
				remove_state_core = 73
			}
			GAL = {
				transfer_state = 73
			}
		}

		every_owned_state = {
			limit = {
				is_core_of = SVK
				NOT = { state = 664 }
			}
			SVK = {
				transfer_state = PREV
			}
		}
		set_autonomy = {
			target = SVK
			autonomy_state = kr_integrated_puppet
		}
		SVK = {
			add_ideas = AUS_part_of_the_Empire
		}
	}

	option = { #no
		name = ausgleich.new.345.b
		ai_chance = {
			factor = 1
			modifier = {
				factor = 0
				OR = {
					has_game_rule = {
						rule = AUS_ausgleich
						option = AUS_AUSGLEICH_FEDERATE_SUCCESS
					}
					has_game_rule = {
						rule = AUS_ausgleich
						option = AUS_AUSGLEICH_FEDERATE_CIVIL_WAR
					}
				}
			}
		}

		add_political_power = -40
		set_country_flag = AUS_slovakia_occupied
	}
}

#Transylvania release mission
country_event = {
	id = ausgleich.new.346
	title = ausgleich.new.346.t
	desc = ausgleich.new.346.d

	is_triggered_only = yes
	
	immediate = {
		log = "[GetDateText]: [Root.GetName]: event ausgleich.new.346"
		hidden_effect = {
			TRS = {
				add_state_core = 82
				add_state_core = 83
				add_state_core = 84
			}
		}
	}

	option = { # yes.
		name = ausgleich.new.346.a
		ai_chance = {
			factor = 99
			modifier = {
				factor = 0
				has_game_rule = {
					rule = AUS_ausgleich
					option = AUS_AUSGLEICH_MILITARY_OCCUPATION
				}
			}
			modifier = {
				factor = 0
				has_country_flag = AUS_slovakia_occupied
			}
		}

		hidden_effect = {
			every_owned_state = {
				limit = {
					is_core_of = TRS
				}
				HUN = {
					remove_state_core = PREV
				}
			}
			HUN = {
				add_state_core = 789
			}
		}
		if = {
			limit = {
				owns_state = 45
				CRO = {
					is_subject_of = ROOT
				}
				45 = {
					is_owned_by = ROOT
					is_core_of = GAL
				}
			}
			CRO = {
				transfer_state = 45
			}
		}
		if = {
			limit = {
				owns_state = 875
				CRO = {
					is_subject_of = ROOT
				}
				875 = {
					is_owned_by = ROOT
					is_core_of = GAL
				}
			}
			CRO = {
				transfer_state = 875
			}
		}
		every_owned_state = {
			limit = {
				is_core_of = TRS
			}
			TRS = {
				transfer_state = PREV
			}
		}
		set_autonomy = {
			target = TRS
			autonomy_state = kr_integrated_puppet
		}
		TRS = {
			add_ideas = AUS_part_of_the_Empire
		}
	}

	option = { # no.
		name = ausgleich.new.346.b
		ai_chance = {
			factor = 1
			modifier = {
				factor = 0
				OR = {
					has_game_rule = {
						rule = AUS_ausgleich
						option = AUS_AUSGLEICH_FEDERATE_SUCCESS
					}
					has_game_rule = {
						rule = AUS_ausgleich
						option = AUS_AUSGLEICH_FEDERATE_CIVIL_WAR
					}
				}
			}
		}

		add_political_power = -40
		set_country_flag = AUS_transylvania_occupied
	}
}

#Hungary release mission
country_event = {
	id = ausgleich.new.347
	immediate = { log = "[GetDateText]: [Root.GetName]: event ausgleich.new.347" }
	title = ausgleich.new.347.t
	desc = ausgleich.new.347.d

	is_triggered_only = yes

	option = { # yes.
		name = ausgleich.new.347.a
		ai_chance = {
			factor = 99
			modifier = {
				factor = 0
				has_game_rule = {
					rule = AUS_ausgleich
					option = AUS_AUSGLEICH_MILITARY_OCCUPATION
				}
			}
			modifier = {
				factor = 0
				OR = {
					has_country_flag = AUS_slovakia_occupied
					has_country_flag = AUS_transylvania_occupied
				}
			}
		}
		set_country_flag = AUS_a_new_Hungary
		every_owned_state = {
			limit = {
				is_core_of = HUN
				NOT = {
					is_core_of = AUS
				}
			}
			HUN = {
				transfer_state = PREV
			}
		}
		set_autonomy = {
			target = HUN
			autonomy_state = kr_integrated_puppet
		}
		HUN = {
			add_ideas = AUS_part_of_the_Empire
			meta_effect = {
				text = {
					create_country_leader = {
						name = "József Ágost Habsburg–Lotaringiai"
						desc = "POLITICS_JOSEPH_AUGUST_VON_HABSBURG_DESC"
						picture = "gfx/leaders/AUS/Portrait_AUS_Joseph_August_von_Habsburg.tga"
						expire = "1965.1.1"
						ideology = [OVERLORD_IDEOLOGY]
					}
				}
				OVERLORD_IDEOLOGY = "[Root.GetRulingIdeologySubtype]"
			}
			set_country_flag = HUN_AUS_was_puppeted
		}
	}

	option = { # no.
		name = ausgleich.new.347.b
		ai_chance = {
			factor = 1
			modifier = {
				factor = 0
				OR = {
					has_game_rule = {
						rule = AUS_ausgleich
						option = AUS_AUSGLEICH_FEDERATE_SUCCESS
					}
					has_game_rule = {
						rule = AUS_ausgleich
						option = AUS_AUSGLEICH_FEDERATE_CIVIL_WAR
					}
				}
			}
		}

		add_political_power = -40
		set_country_flag = AUS_hungary_occupied
	}
}

###Military Occupation revolt
country_event = {
	id = ausgleich.new.350
	immediate = { log = "[GetDateText]: [Root.GetName]: event ausgleich.new.350" }
	title = ausgleich.new.350.t
	desc = ausgleich.new.350.d

	fire_only_once = yes
	is_triggered_only = yes

	option = { # yes.
		name = ausgleich.new.350.a
		ai_chance = {
			factor = 99
		}
		hidden_effect = {
			separate_peace_all_wars = yes
			leave_faction = yes
			load_oob = BOM_AusCivWar
			GAL = {
				country_event = {
					id = ausgleich.new.351
					days = 1
				}
			}
			CRO = {
				country_event = {
					id = ausgleich.new.351
					days = 1
				}
			}
		}
		AUS = {
			set_autonomy = {
				target = CZE
				autonomy_state = autonomy_free
			}
		}
		declare_war_on = {
			target = AUS
			type = annex_everything
		}

		create_faction = brotherhood_of_slavs
		custom_effect_tooltip = "Seven new militia divisions will be formed"
	}

	option = { # no.
		name = ausgleich.new.350.b
		ai_chance = {
			factor = 1
			modifier = {
				factor = 0
				has_game_rule = {
					rule = AUS_ausgleich
					option = AUS_AUSGLEICH_MILITARY_OCCUPATION
				}
			}
		}

		add_political_power = -100
	}
}

country_event = { #Bohemian faction building
	id = ausgleich.new.351
	immediate = { log = "[GetDateText]: [Root.GetName]: event ausgleich.new.351" }
	title = ausgleich.new.351.t
	desc = ausgleich.new.351.d

	is_triggered_only = yes

	option = {
		name = ausgleich.new.351.a
		ai_chance = {
			factor = 97
		}

		add_political_power = 100
		hidden_effect = {
			separate_peace_all_wars = yes
			leave_faction = yes
		}
		AUS = {
			set_autonomy = {
				target = ROOT
				autonomy_state = autonomy_free
			}
		}
		CZE = {
			add_to_faction = ROOT
			add_political_power = 100
			country_event = {
				id = ausgleich.new.352
				days = 2
			}
		}

	}

	option = {
		name = ausgleich.new.351.b
		ai_chance = {
			factor = 3
			modifier = {
				factor = 0
				has_game_rule = {
					rule = AUS_ausgleich
					option = AUS_AUSGLEICH_MILITARY_OCCUPATION
				}
			}
		}

		add_political_power = -100
	}
}

country_event = { #CZE faction: War is declared
	id = ausgleich.new.352
	immediate = { log = "[GetDateText]: [Root.GetName]: event ausgleich.new.352" }
	title = ausgleich.new.352.t
	desc = ausgleich.new.352.d

	fire_only_once = yes
	is_triggered_only = yes

	option = {
		name = ausgleich.new.352.a

		add_political_power = 100
		add_to_war = {
			targeted_alliance = CZE
			enemy = AUS
		}
		AUS = {
			country_event = ausgleich.new.353
		}
	}
}

country_event = { #AUS: War is declared
	id = ausgleich.new.353
	immediate = { log = "[GetDateText]: [Root.GetName]: event ausgleich.new.353" }
	title = ausgleich.new.353.t
	desc = ausgleich.new.353.d

	fire_only_once = yes
	is_triggered_only = yes

	option = {
		name = ausgleich.new.353.a
		add_political_power = -100
	}
}

###Integration of the Constituents
country_event = {
	id = ausgleich.new.700
	immediate = { log = "[GetDateText]: [Root.GetName]: event ausgleich.new.700" }
	title = ausgleich.new.700.t
	desc = ausgleich.new.700.d

	is_triggered_only = yes

	option = { #okay
		name = ausgleich.new.700.a

		ai_chance = {
			factor = 100
		}
		add_political_power = -100
		AUS = {
			country_event = {
				id = ausgleich.new.701
				days = 1
			}
		}
	}
	option = { #no
		name = ausgleich.new.700.b

		ai_chance = {
			factor = 0
		}
		add_political_power = -100
	}
	option = { #independence
		name = ausgleich.new.700.c

		ai_chance = {
			factor = 0
		}
		add_political_power = -300
		declare_war_on = {
			target = AUS
			type = annex_everything
		}
	}
}

country_event = { #integrating the subjects
	id = ausgleich.new.701
	immediate = { log = "[GetDateText]: [Root.GetName]: event ausgleich.new.701" }
	title = ausgleich.new.701.t
	desc = ausgleich.new.701.d

	is_triggered_only = yes

	option = {
		name = ausgleich.new.701.a
		every_state = {
			limit = {
				is_core_of = FROM
			}
			add_core_of = AUS
		}
		if = {
			limit = {
				OR = {
					NOT = { country_exists = HUN }
					AND = {
						FROM = { tag = HUN }
						has_idea = AUS_k_u_k_armee_bonus_2
					}
				}
			}
			remove_ideas = {
				AUS_k_u_k_armee_bonus
				AUS_k_u_k_armee_bonus_2
			}
		}
		else = {
			swap_ideas = {
				remove_idea = AUS_k_u_k_armee_bonus
				add_idea = AUS_k_u_k_armee_bonus_2
			}
		}
		annex_country = {
			target = FROM
			transfer_troops = yes
		}

		add_political_power = 20
		if = {
			limit = {
				has_completed_focus = AUS_status_quo
			}
			set_cosmetic_tag = AUS_CIS
		}
	}
}

country_event = { #ROM attacks revolter HUN
	id = ausgleich.new.702
	immediate = { log = "[GetDateText]: [Root.GetName]: event ausgleich.new.702" }
	title = ausgleich.new.702.t
	desc = ausgleich.new.702.d

	is_triggered_only = yes

	option = {
		name = ausgleich.new.702.a
		ai_chance = {
			factor = 100
			modifier = {
				add = -75
				surrender_progress > 0.4
			}
			modifier = {
				add = -50
				any_enemy_country = {
					is_actual_major = yes
				}
			}
		}
		declare_war_on = {
			target = FROM
			type = annex_everything
		}
	}

	option = {
		name = ausgleich.new.702.b
		ai_chance = {
			factor = 0
			modifier = {
				add = 75
				surrender_progress > 0.4
			}
			modifier = {
				add = 50
				any_enemy_country = {
					is_actual_major = yes
				}
			}
		}
		add_political_power = -100
	}
}

### Belgrade Pact-Austrian Peace Deal

country_event = { #We're losing, sue for peace? (AUS)
	id = ausgleich.new.800
	title = ausgleich.new.800.t
	desc = ausgleich.new.800.d
	
	trigger = {
		tag = AUS
		is_valid_peace_target = yes
		OR = {
			AND = {
				has_war_with = SER
				SER = { is_valid_peace_target = yes }
			}
			AND = {
				46 = { #ROM/RRM
					owner = {
						has_war_with = ROOT
						is_valid_peace_target = yes
					}
				}
			}
		}
		OR = {
			surrender_progress > 0.5
			AND = {
				surrender_progress > 0.3
				count_triggers = {
					amount = 2
					HUN = {
						is_subject_of = ROOT
						OR = {
							has_capitulated = yes
							surrender_progress > 0.5
						}
					}
					CZE = {
						is_subject_of = ROOT
						OR = {
							has_capitulated = yes
							surrender_progress > 0.5
						}
					}
					CRO = {
						is_subject_of = ROOT
						OR = {
							has_capitulated = yes
							surrender_progress > 0.5
						}
					}
					GAL = {
						is_subject_of = ROOT
						OR = {
							has_capitulated = yes
							surrender_progress > 0.8
						}
					}
				}
			}
		}
	}
	
	fire_only_once = yes
	
	immediate = {
		log = "[GetDateText]: [Root.GetName]: event ausgleich.new.800"
		random_enemy_country = {
			limit = {
				is_valid_peace_target = yes
				OR = {
					tag = SER
					tag = ROM
					tag = RRM
				}
			}
		}
		save_event_target_as = AUS_belgrade_pact_leader
		hidden_effect = {
			country_event = { id = ausgleich.new.802 days = 3 }
		}
	}

	option = {
		name = ausgleich.new.800.a
		ai_chance = {
			factor = 100
		}
		event_target:AUS_belgrade_pact_leader = {
			country_event = { id = ausgleich.new.801 days = 1 random = 24 }
		}
		if = {
			limit = {
				POL = {
					has_war_with = ROOT
					is_valid_peace_target = yes 
				}
			}
			POL = {
				country_event = { id = ausgleich.new.801 days = 1 random = 24 }
			}
		}
		if = {
			limit = { #Italians
				any_enemy_country = {
					is_italian_tag = yes
					is_neighbor_of = ROOT
					is_valid_peace_target = yes
				}
			}
			random_enemy_country = {
				limit = {
					is_italian_tag = yes
					is_neighbor_of = ROOT
					is_valid_peace_target = yes
				}
				country_event = { id = ausgleich.new.801 days = 1 random = 24 }
			}
		}
	}

	option = {
		name = ausgleich.new.800.b
		trigger = {
			is_ai = no
		}
		add_stability = -0.1
		add_war_support = -0.1
	}
}

country_event = { #Austria seeks peace (SER/ROM/POL/ITA)
	id = ausgleich.new.801
	immediate = { log = "[GetDateText]: [Root.GetName]: event ausgleich.new.801" }
	title = ausgleich.new.801.t
	desc = ausgleich.new.801.d
	
	trigger = {
		has_war_with = FROM
	}

	is_triggered_only = yes

	option = {
		name = ausgleich.new.801.a
		ai_chance = {
			factor = 100
		}
		set_country_flag = AUS_accepts_peace
		if = {
			limit = {
				OR = {
					num_subjects > 0
					is_faction_leader = yes
				}
			}
			every_other_country = {
				limit = {
					OR = {
						is_subject_of = ROOT
						is_in_faction_with = ROOT
					}
				}
				set_country_flag = AUS_accepts_peace
			}
		}
		effect_tooltip = {
			FROM = {
				country_event = { id = ausgleich.new.802 days = 1 random = 24 }
			}
		}
	}

	option = {
		name = ausgleich.new.801.b
		trigger = {
			is_ai = no
		}
		add_stability = -0.2
		add_war_support = -0.2
		FROM = {
			country_event = ausgleich.new.804
		}
	}
}

country_event = { #Treaty of Budapest
	id = ausgleich.new.802
	title = ausgleich.new.802.t
	desc = ausgleich.new.802.d
	
	trigger = {
		any_enemy_country = { has_country_flag = AUS_accepts_peace }
	}

	is_triggered_only = yes
	
	immediate = {
		log = "[GetDateText]: [Root.GetName]: event ausgleich.new.802"
		random_enemy_country = {
			limit = {
				is_italian_tag = yes
				has_country_flag = AUS_accepts_peace
			}
			save_event_target_as = AUS_italian_target
		}
		random_enemy_country = {
			limit = {
				is_polish_tag = yes
				has_country_flag = AUS_accepts_peace
			}
			save_event_target_as = AUS_polish_target
		}
		random_enemy_country = {
			limit = {
				OR = {
					tag = ROM
					tag = RRM
				}
				has_country_flag = AUS_accepts_peace
			}
			save_event_target_as = AUS_romanian_target
		}
	}
	
	option = {
		name = ausgleich.new.802.a
		hidden_effect = {
			### Italian claims
			if = {
				limit = { has_event_target = AUS_italian_target }
				every_owned_state = {
					limit = {
						OR = {
							state = 39 #Alto Adige
							state = 736 #Istria
							state = 783 #Trentino
						}
					}
					event_target:AUS_italian_target = { transfer_state = PREV }
				}
			}
			
			### Polish claims
			if = {
				limit = { has_event_target = AUS_polish_target }
				every_owned_state = {
					limit = {
						region = 155 #Galicia
					}
					event_target:AUS_polish_target = { transfer_state = PREV }
				}
				if = {
					limit = { has_subject = GAL }
					GAL = {
						every_owned_state = {
							limit = {
								NOT = { region = 155 } #Galicia
							}
							ROOT = { transfer_state = PREV }
						}
					}
					set_autonomy = {
						target = GAL
						autonomy_state = autonomy_free
					}
					remove_from_faction = GAL
				}
			}
			
			### Serbian claims
			if = {
				limit = {
					SER = {
						has_war_with = ROOT
						has_country_flag = AUS_accepts_peace
					}
				}
				
				### Release CRO, if it's to be annexed
				if = {
					limit = {
						SER = { has_completed_focus = SER_slavic_federation }
					}
					if = {
						limit = { has_subject = CRO }
						set_autonomy = {
							target = CRO
							autonomy_state = autonomy_free
						}
						remove_from_faction = CRO
					}
				}
				### Illyria reverts to Croatia if it survives the deal
				else = {
					CRO = {
						if = {
							limit = {
								is_subject_of = ROOT
								has_cosmetic_tag = CRO_ILL
							}
							drop_cosmetic_tag = yes
						}
					}
				}
				
				### Cede all claims
				every_state = {
					limit = {
						if = {
							limit = {
								SER = { has_completed_focus = SER_slavic_federation }
							}
							OR = {
								region = 143 #Northern Balkans
								state = 45 #Vojvodina
								state = 105 #Montenegro
								state = 102 #Slovenia
								state = 736 #Istria
								state = 875 #West Banat
							}
						}
						else = {
							OR = {
								state = 45 #Vojvodina
								state = 104 #Bosnia
								state = 105 #Montenegro
								state = 794 #Syrmia
								state = 875 #West Banat
							}
						}
						OR = {
							is_owned_by = ROOT
							owner = { is_subject_of = ROOT }
						}
					}
					SER = { transfer_state = PREV }
				}
			}
			
			### Romanian claims
			if = {
				limit = { has_event_target = AUS_romanian_target }
				
				### Release TRS, if it's to be annexed
				if = {
					limit = { has_subject = TRS }
					set_autonomy = {
						target = TRS
						autonomy_state = autonomy_free
					}
					remove_from_faction = TRS
				}
				
				### Cede all claims
				every_state = {
					limit = {
						region = 144 #Transylvania
						OR = {
							is_owned_by = ROOT
							owner = { is_subject_of = ROOT }
						}
					}
					event_target:AUS_romanian_target = { transfer_state = PREV }
				}
			}
			
			### Dismantle Austria's faction if they lost against the Belgrade Pact
			if = {
				limit = {
					event_target:AUS_belgrade_pact_leader = { has_country_flag = AUS_accepts_peace }
				}
				dismantle_faction = yes
				news_event = { id = ausgleich.new.805 days = 2 }
			}
			
			### Peace everyone out
			every_other_country = {
				limit = { has_country_flag = AUS_accepts_peace }
				set_country_flag = { flag = AUS_had_war days = 5 value = 1 }
				clr_country_flag = AUS_accepts_peace
				country_event = ausgleich.new.803
				if = {
					limit = { is_valid_peace_target = yes }
					white_peace_with_ROOT = yes
				}
			}
		}
	}
}

country_event = { #Victory Against Austria (SER/ROM/POL/ITA)
	id = ausgleich.new.803
	immediate = { log = "[GetDateText]: [Root.GetName]: event ausgleich.new.803" }
	title = ausgleich.new.803.t
	desc = ausgleich.new.803.d

	is_triggered_only = yes

	option = {
		name = ausgleich.new.803.a
		add_political_power = 100
	}
}

country_event = { #FROM refuses peace (AUS)
	id = ausgleich.new.804
	immediate = { log = "[GetDateText]: [Root.GetName]: event ausgleich.new.804" }
	title = ausgleich.new.804.t
	desc = ausgleich.new.804.d

	is_triggered_only = yes

	option = {
		name = ausgleich.new.804.a
		add_war_support = 0.1
	}
}


news_event = { #The Treaty of Budapest
	id = ausgleich.new.805
	immediate = { log = "[GetDateText]: [Root.GetName]: event ausgleich.new.805" }
	title = ausgleich.new.805.t
	desc = ausgleich.new.805.d

	is_triggered_only = yes
	major = yes

	trigger = {
		wants_world_news = yes
	}
	
	show_major = {
		NOT = { has_country_flag = AUS_had_war }
	}

	option = {
		name = ausgleich.new.805.a
	}
}